{% extends "core/base.html" %}
{% load static i18n %}

{% block title %}ุฅุนุฏุงุฏุงุช ุงูุญุณุงุจ โ ูุชูุงุชุฑ{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/account_settings.css' %}">
{% endblock %}

{% block content %}
<div class="acc-wrap">
  <!-- Messages -->
  {% if messages %}
  <div class="messages">
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }}">
      {{ message }}
    </div>
    {% endfor %}
  </div>
  {% endif %}

  <!-- Profile Settings -->
  <div class="acc-card">
    <h2 class="acc-title">ุฅุนุฏุงุฏุงุช ุงูููู ุงูุดุฎุตู</h2>
    <p class="acc-subtitle">ูู ุจุชุญุฏูุซ ูุนูููุงุชู ุงูุดุฎุตูุฉ ูุฅุนุฏุงุฏุงุช ุงูุญุณุงุจ</p>
    
    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}
      
      <!-- Avatar Section -->
      <div class="avatar-section">
        <div class="avatar-lg" id="avatar-preview">
          {% if student.avatar %}
            <img src="{{ student.avatar.url }}" alt="ุตูุฑุฉ ุงูุญุณุงุจ">
          {% else %}
            <div class="avatar-fallback">{{ student.display_name|first|upper }}</div>
          {% endif %}
        </div>
        
        <div class="file-input-wrapper">
          <input type="file" name="avatar" id="id_avatar" accept="image/*" class="form-control">
          <label for="id_avatar" class="file-input-button">
            ๐ท ุชุบููุฑ ุงูุตูุฑุฉ
          </label>
        </div>
        
        {% if student.avatar %}
        <div class="remove-avatar-section">
          <input type="checkbox" name="remove_avatar" id="remove_avatar" class="remove-avatar-checkbox">
          <button type="button" class="btn-remove-avatar">๐๏ธ ุญุฐู ุงูุตูุฑุฉ</button>
        </div>
        {% endif %}
      </div>

      <!-- Display Name -->
      <div class="form-group">
        <label for="id_display_name" class="form-label">ุงูุงุณู ุงููุนุฑูุถ</label>
        <input type="text" name="display_name" id="id_display_name" class="form-control" 
               value="{{ form.display_name.value|default:student.display_name }}" 
               placeholder="ุฃุฏุฎู ุงุณูู">
        <div class="hint">ูุฐุง ุงูุงุณู ุณูุธูุฑ ูู ุฌููุน ุฃูุญุงุก ุงููููุน</div>
      </div>

      <!-- Skin Selection -->
      <div class="form-group">
        <label class="form-label">ุงุฎุชูุงุฑ ุงููุธูุฑ</label>
        <div class="skin-grid">
          {% for choice in form.skin %}
            <div class="skin-option {% if choice.choice_value == student.skin %}selected{% endif %}">
              {{ choice.tag }}
              <img src="{% static 'img/skins/skin'|add:choice.choice_value|add:'.jpg' %}" 
                   alt="ูุธูุฑ {{ choice.choice_label }}" class="skin-preview">
              <div class="skin-info">{{ choice.choice_label }}</div>
            </div>
          {% endfor %}
        </div>
        <div class="hint">ุงุฎุชุฑ ุงููุธูุฑ ุงูุฐู ุชูุถูู ูููุงุฌูุฉ</div>
      </div>

      <!-- Form Actions -->
      <div class="form-actions">
        <button type="submit" class="btn-lg btn-primary">
          ๐พ ุญูุธ ุงูุชุบููุฑุงุช
        </button>
        <a href="{% url 'core:main_menu' %}" class="btn-lg btn-secondary">
          โ ุงูุนูุฏุฉ ูููุงุฆูุฉ ุงูุฑุฆูุณูุฉ
        </a>
      </div>
    </form>
  </div>

  <!-- Password Change -->
  <div class="acc-card">
    <h2 class="acc-title">ุชุบููุฑ ูููุฉ ุงููุฑูุฑ</h2>
    <p class="acc-subtitle">ูู ุจุชุญุฏูุซ ูููุฉ ุงููุฑูุฑ ูุญูุงูุฉ ุญุณุงุจู</p>
    
    <form method="post" action="{% url 'core:password_change' %}">
      {% csrf_token %}
      
      <div class="form-group">
        <label for="id_old_password" class="form-label">ูููุฉ ุงููุฑูุฑ ุงูุญุงููุฉ</label>
        <input type="password" name="old_password" id="id_old_password" class="form-control" 
               placeholder="ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ ุงูุญุงููุฉ" required>
      </div>

      <div class="form-group">
        <label for="id_new_password1" class="form-label">ูููุฉ ุงููุฑูุฑ ุงูุฌุฏูุฏุฉ</label>
        <input type="password" name="new_password1" id="id_new_password1" class="form-control" 
               placeholder="ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ ุงูุฌุฏูุฏุฉ" required>
      </div>

      <div class="form-group">
        <label for="id_new_password2" class="form-label">ุชุฃููุฏ ูููุฉ ุงููุฑูุฑ ุงูุฌุฏูุฏุฉ</label>
        <input type="password" name="new_password2" id="id_new_password2" class="form-control" 
               placeholder="ุฃุนุฏ ุฅุฏุฎุงู ูููุฉ ุงููุฑูุฑ ุงูุฌุฏูุฏุฉ" required>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn-lg btn-primary">
          ๐ ุชุบููุฑ ูููุฉ ุงููุฑูุฑ
        </button>
      </div>
    </form>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/account_settings.js' %}"></script>
{% endblock %}


